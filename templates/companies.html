{% extends "base.html" %}

{% block title %}Companies - SARI TEXTILE WAREHOUSES ACCOUNTING{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Companies</h1>
    <div class="action-buttons">
        <button class="btn btn-primary" onclick="openAddCompanyModal()">+ Add Company</button>
    </div>
</div>

<div class="filters">
    <div class="filters-row">
        <div class="form-group">
            <label>Category</label>
            <select id="filterCategory" onchange="loadCompanies()">
                <option value="">All</option>
                <option value="Supplier">Suppliers</option>
                <option value="Service Company">Service Companies</option>
                <option value="Customer">Customers</option>
            </select>
        </div>
    </div>
</div>

<div class="table-container">
    <table id="companiesTable">
        <thead>
            <tr>
                <th class="sortable">Name</th>
                <th>Address</th>
                <th class="sortable">Category</th>
                <th>Payment Type</th>
                <th class="sortable">Currency</th>
                <th class="sortable">Balance</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="companiesTableBody">
            <tr><td colspan="7" class="empty-state">Loading...</td></tr>
        </tbody>
    </table>
</div>

<!-- Total Balances Summary -->
<div id="totalBalancesSummary" class="report-summary" style="display: none;">
    <h3>Total Balances Summary</h3>
    <div class="report-summary-grid" id="totalBalancesGrid">
        <!-- Will be populated by JavaScript -->
    </div>
</div>

<!-- Add/Edit Company Modal -->
<div id="companyModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeCompanyModal()">&times;</span>
        <h2 id="modalTitle">Add Company</h2>
        <form id="companyForm">
            <input type="hidden" id="companyId">
            <div class="form-group">
                <label>Name *</label>
                <input type="text" id="companyName" required>
            </div>
            <div class="form-group">
                <label>Address</label>
                <textarea id="companyAddress" rows="3"></textarea>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Category *</label>
                    <select id="companyCategory" required onchange="togglePaymentType()">
                        <option value="">Select Category</option>
                        <option value="Supplier">Supplier</option>
                        <option value="Service Company">Service Company</option>
                        <option value="Customer">Customer</option>
                    </select>
                </div>
                <div class="form-group" id="paymentTypeGroup" style="display: none;">
                    <label>Payment Type</label>
                    <select id="companyPaymentType">
                        <option value="Cash">Cash</option>
                        <option value="Credit">Credit</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label>Currency *</label>
                <input type="text" id="companyCurrency" required>
            </div>
            <div class="action-buttons">
                <button type="submit" class="btn btn-primary">Save</button>
                <button type="button" class="btn btn-secondary" onclick="closeCompanyModal()">Cancel</button>
            </div>
        </form>
    </div>
</div>

<script src="{{ url_for('static', filename='js/companies.js') }}"></script>
{% endblock %}

